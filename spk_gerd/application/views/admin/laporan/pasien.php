  <div class="layout-px-spacing">

    <div class="middle-content container-xxl p-0">

      <!-- BREADCRUMB -->
      <div class="page-meta">
        <nav class="breadcrumb-style-one" aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Laporan</a></li>
            <li class="breadcrumb-item active" aria-current="page">Laporan Pasien</li>
          </ol>
        </nav>
      </div>
      <!-- /BREADCRUMB -->
      <div class="row layout-top-spacing">

        <div class="col-xl-12 col-lg-12 col-sm-12  layout-spacing">
          <div class="card">
            <div class="card-header">
              <svg width="32px" height="32px" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#04009a;}.cls-2{fill:#77acf1;}</style></defs><g data-name="13. Computer" id="_13._Computer"><path class="cls-1" d="M28,3H26a1,1,0,0,0,0,2h2a1,1,0,0,1,1,1V20H3V6A1,1,0,0,1,4,5H6A1,1,0,0,0,6,3H4A3,3,0,0,0,1,6V24a3,3,0,0,0,3,3h7.88A4.53,4.53,0,0,1,10,29.83L9.7,30H8a1,1,0,0,0,0,2H24a1,1,0,0,0,0-2H22.3l-.25-.17A4.53,4.53,0,0,1,20.12,27H28a3,3,0,0,0,3-3V6A3,3,0,0,0,28,3ZM19.36,30H12.64a6.55,6.55,0,0,0,1.28-3h4.16A6.55,6.55,0,0,0,19.36,30ZM28,25H4a1,1,0,0,1-1-1V22H29v2A1,1,0,0,1,28,25Z"/><path class="cls-1" d="M16,16a8,8,0,1,1,8-8A8,8,0,0,1,16,16ZM16,2a6,6,0,1,0,6,6A6,6,0,0,0,16,2Z"/><path class="cls-2" d="M18,7H17V6a1,1,0,0,0-2,0V7H14a1,1,0,0,0,0,2h1v1a1,1,0,0,0,2,0V9h1a1,1,0,0,0,0-2Z"/></g></svg> Laporan Pasien
            </div>
            <div class="card-body">
              <div class="text-center user-info">

                <svg width="64px" height="64px" viewBox="0 -0.18 64 64" xmlns="http://www.w3.org/2000/svg">
                  <g id="Group_127" data-name="Group 127" transform="translate(-52.725 -50.435)">
                    <g id="XMLID_1_">
                      <g id="Group_126" data-name="Group 126">
                        <path id="Path_58" data-name="Path 58" d="M116.725,76v36.08a2,2,0,0,1-2,2h-60a2.006,2.006,0,0,1-2-2V68.755a2,2,0,0,1,2-2h1.67v-7.59a2.006,2.006,0,0,1,2-2h2v-4.73a2.006,2.006,0,0,1,2-2h49.03a2.006,2.006,0,0,1,2,2V74h1.3A1.993,1.993,0,0,1,116.725,76Zm-4,34.08V78H78.4a2.041,2.041,0,0,1-1.38-.55l-7.09-6.7H56.725v39.33ZM109.425,74V54.435H64.4v2.73h40.03a2.006,2.006,0,0,1,2,2V74Zm-7,0V61.165H60.4v5.59h10.33a2.013,2.013,0,0,1,1.38.54L79.2,74Z" fill="#03373d"/>
                        <path id="Path_59" data-name="Path 59" d="M112.725,78v32.08h-56V70.755h13.21l7.09,6.7A2.041,2.041,0,0,0,78.4,78Zm-15,15.83a13,13,0,1,0-13,13A13.012,13.012,0,0,0,97.725,93.835Z" fill="#ccc"/>
                        <path id="Path_60" data-name="Path 60" d="M109.425,54.435v19.57h-3V59.165a2.006,2.006,0,0,0-2-2H64.4v-2.73h45.03Z" fill="#ef472e"/>
                        <path id="Path_61" data-name="Path 61" d="M102.425,61.165v12.84H79.2l-7.09-6.71a2.013,2.013,0,0,0-1.38-.54H60.4v-5.59h42.03Z" fill="#f2f2f2"/>
                        <path id="Path_62" data-name="Path 62" d="M84.725,80.835a13,13,0,1,1-13,13A13.012,13.012,0,0,1,84.725,80.835Zm9,13a9,9,0,1,0-9,9A9.007,9.007,0,0,0,93.725,93.835Z" fill="#03373d"/>
                        <path id="Path_63" data-name="Path 63" d="M90.915,91.345v4.97l-3.7.01v3.7h-4.97v-3.7h-3.7v-4.97l3.7-.01v-3.7h4.97v3.7Z" fill="#ef472e"/>
                      </g>
                    </g>
                  </g>
                </svg>
                <br>
                <p class=""><b>Laporan Pasien</b></p>
              </div>
              <form action="javascript:void(0)" id="form_laporan" method="POST">
                <div class="row">
                  <div class="col-md-6 p-2">
                    <label for="penyakit" class="form-label">Tanggal Awal</label>
                    <input type="date" name="tgl_awal" id="tgl_awal" class="form-control" placeholder="Tanggal Awal">
                  </div>
                  <div class="col-md-6 p-2">
                    <label for="penyakit" class="form-label">Tanggal Akhir</label>
                    <input type="date" name="tgl_akhir" id="tgl_akhir" class="form-control" placeholder="Tanggal Akhir">
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 p-2">
                    <label for="username" class="form-label">Jenis Kelamin</label>
                    <div class="custom-control custom-radio">
                      <input type="radio" id="lk" value="laki-laki" name="jk" class="custom-control-input jk">
                      <label class="custom-control-label" for="lk">Laki - Laki</label>
                    </div>
                    <div class="custom-control custom-radio">
                      <input type="radio" id="pr" name="jk" value="perempuan" class="custom-control-input jk">
                      <label class="custom-control-label" for="pr">Perempuan</label>
                    </div>
                  </div>
                  <div class="col-md-6 p-2">
                    <select id="usia" name="usia" class="form-control">
                      <option value="">Usia</option>
                      <?php foreach($usia as $u): ?>
                        <option value="<?=$u->usia?>"><?=$u->usia?></option>
                      <?php endforeach; ?>
                    </select>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 p-2">
                    <button type="submit" name="submit" id="submit" class="btn btn-secondary w-100">Submit</button>
                  </div>
                </div>

              </form>
            </div>
          </div>
          <br />
          <div class="card">
           <div class="card-header">
            <svg width="32px" height="32px" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#04009a;}.cls-2{fill:#77acf1;}</style></defs><g data-name="13. Computer" id="_13._Computer"><path class="cls-1" d="M28,3H26a1,1,0,0,0,0,2h2a1,1,0,0,1,1,1V20H3V6A1,1,0,0,1,4,5H6A1,1,0,0,0,6,3H4A3,3,0,0,0,1,6V24a3,3,0,0,0,3,3h7.88A4.53,4.53,0,0,1,10,29.83L9.7,30H8a1,1,0,0,0,0,2H24a1,1,0,0,0,0-2H22.3l-.25-.17A4.53,4.53,0,0,1,20.12,27H28a3,3,0,0,0,3-3V6A3,3,0,0,0,28,3ZM19.36,30H12.64a6.55,6.55,0,0,0,1.28-3h4.16A6.55,6.55,0,0,0,19.36,30ZM28,25H4a1,1,0,0,1-1-1V22H29v2A1,1,0,0,1,28,25Z"/><path class="cls-1" d="M16,16a8,8,0,1,1,8-8A8,8,0,0,1,16,16ZM16,2a6,6,0,1,0,6,6A6,6,0,0,0,16,2Z"/><path class="cls-2" d="M18,7H17V6a1,1,0,0,0-2,0V7H14a1,1,0,0,0,0,2h1v1a1,1,0,0,0,2,0V9h1a1,1,0,0,0,0-2Z"/></g></svg>Data Laporan Pasien
          </div>
          <div class="card-body">
            <div id="tombole"></div>
            

            <div class="table-responsive">
              <table id="zero-config" class="table table-bordered">
                <thead>
                  <tr>
                    <th>No</th>
                    <th>Tanggal Konsul</th>
                    <th>NIK</th>
                    <th>Nama Lengkap</th>
                    <th>Usia</th>
                    <th>Jenis Kelamin</th>
                    <th>Tanggal Lahir</th>
                    <th>Alamat</th>
                    <th>No Hp</th>
                    <th>Hasil Penyakit</th>
                    <th>Solusi Penyakit</th>
                    <th>Cetak Hasil</th>
                  </tr>
                </thead>
                <tbody id="data_pasien">

                </tbody>
              </table>
            </div>
          </div>
        </div>

      </div>


    </div>
  </div>
</div>

<script>

 function convertDateDBtoIndo(string) {
  bulanIndo = ['', 'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September' , 'Oktober', 'November', 'Desember'];

  tanggal = string.split("-")[2];
  bulan = string.split("-")[1];
  tahun = string.split("-")[0];

  return tanggal + " " + bulanIndo[Math.abs(bulan)] + " " + tahun;
}
$("#form_laporan").submit(function(e){
 e.preventDefault();
 $('#zero-config').DataTable().clear();
 //$("#data_pasien").empty();
 $("#tombole").empty();
 $.ajax({
  url:"<?=base_url('admin/Laporan/tampilkan_pasien/')?>",
  type:"POST",
  data:$("#form_laporan").serialize(),
  dataType:"JSON",
  success:function(data){
    console.log(data.data)
    table = $("#zero-config").DataTable();
    if(data.data != ''){
      var b=1;
      for(var a=0;a<data.data.length;a++){
          // $("#data_pasien").append(` <tr>
          //   <td>${b++}</td>
          //   <td>${data.data[a].nama_pasien}</td>
          //   <td>${data.data[a].tgl_lahir}</td>
          //   <td>${data.data[a].alamat}</td>
          //   <td>${data.data[a].no_hp}</td>
          //   <td>${data.data[a].penyakit}</td>
          //   <td>${data.data[a].penyakit}</td>
          //   </tr>`);
          table.row.add([b++,convertDateDBtoIndo(data.data[a].tgl_input),data.data[a].nik,data.data[a].nama_pasien,data.data[a].usia,data.data[a].jenis_kelamin,convertDateDBtoIndo(data.data[a].tgl_lahir),data.data[a].alamat,data.data[a].no_hp,data.data[a].penyakit,data.data[a].solusi,`<a href="<?=base_url('admin/Diagnosa/cetak_konsul/')?>${data.data[a].kd_konsultasi}" class="btn btn-info mb-2 mr-2" target="_blank">
            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 58 58" style="enable-background:new 0 0 58 58;" xml:space="preserve">
            <polygon style="fill:#C7CAC7;" points="49,35 49,52 52,52 52,49 58,49 58,17 0,17 0,49 6,49 6,52 9,52 9,35 " />
            <polygon style="fill:#556080;" points="58,35 58,17 0,17 0,35 9,35 49,35 " />
            <rect x="6" y="35" style="fill:#7383BF;" width="46" height="17" />
            <polygon style="fill:#EDEADA;" points="49,0 49,7 49,17 9,17 9,0 " />
            <polyline style="fill:#EDEADA;" points="49,35 49,58 9,58 9,35 " />
            <path style="fill:#CEC9AE;" d="M41,44H17c-0.553,0-1-0.447-1-1s0.447-1,1-1h24c0.553,0,1,0.447,1,1S41.553,44,41,44z" />
            <path style="fill:#CEC9AE;" d="M41,49H17c-0.553,0-1-0.447-1-1s0.447-1,1-1h24c0.553,0,1,0.447,1,1S41.553,49,41,49z" />
            <circle style="fill:#A4E869;" cx="49" cy="26" r="4" />
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            </svg>&nbsp;Cetak Hasil Konsultasi</a>`]);
        }  
      }else{
        $("#zero-config").html(`<h3 style="color:#000000;"> <b>Tidak Ada Data</b></h3>`);
      }
      table.draw();

      $("#tombole").append(`<button type="button" onclick="cetak_semua()"  class="btn btn-info mb-2 mr-2">
       <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 58 58" style="enable-background:new 0 0 58 58;" xml:space="preserve">
       <polygon style="fill:#C7CAC7;" points="49,35 49,52 52,52 52,49 58,49 58,17 0,17 0,49 6,49 6,52 9,52 9,35 " />
       <polygon style="fill:#556080;" points="58,35 58,17 0,17 0,35 9,35 49,35 " />
       <rect x="6" y="35" style="fill:#7383BF;" width="46" height="17" />
       <polygon style="fill:#EDEADA;" points="49,0 49,7 49,17 9,17 9,0 " />
       <polyline style="fill:#EDEADA;" points="49,35 49,58 9,58 9,35 " />
       <path style="fill:#CEC9AE;" d="M41,44H17c-0.553,0-1-0.447-1-1s0.447-1,1-1h24c0.553,0,1,0.447,1,1S41.553,44,41,44z" />
       <path style="fill:#CEC9AE;" d="M41,49H17c-0.553,0-1-0.447-1-1s0.447-1,1-1h24c0.553,0,1,0.447,1,1S41.553,49,41,49z" />
       <circle style="fill:#A4E869;" cx="49" cy="26" r="4" />
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       <g></g>
       </svg>&nbsp;Cetak Semua Data</button>`);
      
    },
    error:function(er){

    }
  })
})


  function cetak_semua(){
    var tgl_awal  ="kosong";
    if($("#tgl_awal").val()){
      tgl_awal = $("#tgl_awal").val();
    }

  //alert(tgl_awal);
  var tgl_akhir = "kosong";
  if($("#tgl_akhir").val()){
    tgl_akhir = $("#tgl_akhir").val();
  }
  var jk  = "kosong";
  if($('input[name="jk"]:checked').val()){
    jk=$('input[name="jk"]:checked').val();
  }
  var usia = "kosong";
  if($("#usia").val()){
    usia=$("#usia").val();
  }
  window.open(`<?=base_url('admin/Laporan/cetak_semua/')?>${tgl_awal}/${tgl_akhir}/${jk}/${usia}`);
}

</script>